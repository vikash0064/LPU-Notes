<!DOCTYPE html>
<html>

<head>
    <title>Notes App</title>
    <link rel="icon" type="image/x-icon" href="/logo.png">

    <style>
        :root {
            --bg-light: #f4f6f9;
            --bg-dark: #181a1b;
            --text-light: #333;
            --text-dark: #f4f6f9;
            --header-light: #fff;
            --header-dark: #23272a;
            --card-light: #fff;
            --card-dark: #23272a;
        }
        body[data-theme='dark'] {
            background: var(--bg-dark);
            color: var(--text-dark);
        }
        body[data-theme='dark'] .header {
            background: var(--header-dark);
            color: var(--text-dark);
            box-shadow: 0 2px 10px rgba(0,0,0,0.4);
        }
        body[data-theme='dark'] .form-section,
        body[data-theme='dark'] .note-card {
            background: var(--card-dark);
            color: var(--text-dark);
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }
        body[data-theme='dark'] .btn,
        body[data-theme='dark'] .btn-login,
        body[data-theme='dark'] .btn-register,
        body[data-theme='dark'] .btn-logout {
            background: #444 !important;
            color: #fff !important;
        }
        body[data-theme='dark'] input,
        body[data-theme='dark'] textarea {
            background: #23272a;
            color: #f4f6f9;
            border: 1px solid #444;
        }
        body[data-theme='dark'] a {
            color: #4da3ff;
        }
        body[data-theme='dark'] .save-btn {
            background: #357a38;
        }
        body[data-theme='dark'] .save-btn:hover {
            background: #285c2c;
        }
        body {
            margin: 0;
            font-family: Arial, Helvetica, sans-serif;
            background: #f4f6f9;
        }

        .container {
            display: flex;
            height: calc(100vh - 60px);
            /* Adjust for header */
        }

        .header {
            background: #fff;
            padding: 10px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            height: 70px;
            box-sizing: border-box;
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .header-logo {
            height: 50px;
            width: auto;
        }

        .header h1 {
            margin: 0;
            font-size: 26px;
            color: #333;
            font-weight: 700;
        }

        .auth-buttons a {
            text-decoration: none;
            color: white;
            padding: 8px 15px;
            border-radius: 5px;
            margin-left: 10px;
            font-size: 14px;
        }

        .btn-login {
            background: #007BFF;
        }

        .btn-register {
            background: #28a745;
        }

        .btn-logout {
            background: #dc3545;
        }

        /* LEFT SIDE FORM */
        .form-section {
            width: 35%;
            padding: 30px;
            background: white;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
        }

        h2 {
            margin-top: 0;
        }

        input,
        textarea {
            width: 100%;
            padding: 12px;
            margin-top: 10px;
            border-radius: 8px;
            border: 1px solid #ccc;
            font-size: 14px;
        }

        textarea {
            height: 120px;
            resize: none;
        }

        .save-btn {
            margin-top: 15px;
            width: 100%;
            padding: 12px;
            border: none;
            background: #4CAF50;
            color: white;
            font-size: 16px;
            border-radius: 8px;
            cursor: pointer;
        }

        .save-btn:hover {
            background: #45a049;
        }

        /* RIGHT SIDE NOTES */
        .notes-section {
            width: 65%;
            padding: 30px;
            overflow-y: auto;
        }

        .note-card {
            background: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }

        .note-title {
            margin: 0;
        }

        .note-actions {
            margin-top: 15px;
        }


        .btn {
            padding: 8px 14px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            margin-right: 8px;
            font-size: 13px;
            background: #111;
            color: #fff;
        }

        .delete,
        .edit,
        .view {
            background: #111 !important;
            color: #fff !important;
        }

        .btn:hover {
            opacity: 0.85;
        }
    </style>
</head>

<body>


    <div class="header">
        <div class="header-left">
            <img src="/logo.png" alt="LPU Logo" class="header-logo">
            <h1>LPU Notes</h1>
        </div>
        <div style="display: flex; align-items: center; gap: 15px;">
            <button id="theme-toggle" style="padding: 6px 14px; border-radius: 6px; border: none; cursor: pointer; background: #eee; color: #333; font-size: 15px;">ðŸŒ™ Dark</button>
            <div class="auth-buttons">
                <% if (locals.user) { %>
                    <span>Welcome, <%= user.username %>!</span>
                    <a href="/logout" class="btn-logout">Logout</a>
                <% } else { %>
                    <a href="/login" class="btn-login">Login</a>
                    <a href="/register" class="btn-register">Register</a>
                <% } %>
            </div>
        </div>
        </div>
    </div>

    <div class="container">
        <!-- LEFT SIDE ADD NOTE -->
        <div class="form-section">
            <h2>Add Note</h2>

            <form action="/add-note" method="POST" enctype="multipart/form-data">
                <input type="text" name="title" placeholder="Title" required>
                <textarea name="content" placeholder="Content" required></textarea>
                <input type="file" name="media" accept="image/*,video/*,audio/*" style="margin-top:10px;">
                <button class="save-btn" type="submit">Save Note</button>
            </form>
        </div>

        <!-- RIGHT SIDE NOTES -->
        <div class="notes-section">
            <% if (locals.user) { %>
                <h2>Saved Notes</h2>
                <% if (notes.length> 0) { %>
                    <% notes.forEach(note=> { %>
                        <div class="note-card">
                            <h3 class="note-title">
                                <%= note.title %>
                            </h3>
                            <p>
                                <%= note.content %>
                            </p>
                            <div class="note-actions">
                                <form action="/delete-note/<%= note.id %>" method="POST" style="display:inline;">
                                    <button class="btn delete" type="submit"
                                        onclick="return confirm('Are you sure you want to delete this note?');">Delete</button>
                                </form>
                                <button class="btn edit"
                                    onclick="window.location.href='/edit-note/<%= note.id %>'">Edit</button>
                                <button class="btn view"
                                    onclick="window.location.href='/view-note/<%= note.id %>'">View</button>
                            </div>
                            <% if (note.image) { %>
                                <% if (note.image.match(/\.(jpg|jpeg|png)$/i)) { %>
                                    <img src="/uploads/<%= note.image %>" alt="Note Media"
                                        style="max-width:50%;max-height:200px;margin-top:15px;" />
                                    <% } else { %>
                                        <a href="/uploads/<%= note.image %>" target="_blank">Download attached file</a>
                                        <% } %>
                                            <% } %>
                        </div>
                        <% }) %>
                            <% } else { %>
                                <p>No notes found. Start by adding one!</p>
                                <% } %>
                                    <% } else { %>
                                        <div style="text-align: center; margin-top: 50px;">
                                            <h2>Welcome to LPU Notes</h2>
                                            <p>Please <a href="/login">Login</a> or <a href="/register">Register</a> to
                                                see your saved notes.</p>
                                        </div>
                                        <% } %>
        </div>
    </div>



    <script>
        // Theme toggle logic
        const themeToggle = document.getElementById('theme-toggle');
        function setTheme(theme) {
            document.body.setAttribute('data-theme', theme);
            localStorage.setItem('theme', theme);
            themeToggle.textContent = theme === 'dark' ? 'â˜€ï¸ Light' : 'ðŸŒ™ Dark';
        }
        // On load, set theme from localStorage
        const savedTheme = localStorage.getItem('theme') || 'light';
        setTheme(savedTheme);
        themeToggle.addEventListener('click', () => {
            const current = document.body.getAttribute('data-theme') || 'light';
            setTheme(current === 'light' ? 'dark' : 'light');
        });
    </script>
</body>

</html>